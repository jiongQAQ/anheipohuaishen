# 软件B运行时间记录功能

## 📋 功能概述

新增了软件B运行时间记录功能，能够自动记录软件B的启动时间、结束时间和运行持续时间，并保存到专门的日志文件中。

## 🚀 功能特点

- ✅ **自动记录**：无需手动操作，系统自动记录软件B的运行时间
- ✅ **详细信息**：记录开始时间、结束时间、持续时间和进程名称
- ✅ **多种状态**：支持正常结束、异常退出、手动停止等不同状态
- ✅ **统计功能**：可查看总运行次数和总运行时间
- ✅ **格式清晰**：日志格式清晰易读，便于分析

## 📁 日志文件

### 文件位置
- **文件名**：`software_b_runtime.log`
- **位置**：项目根目录

### 日志格式示例
```
=== 软件B运行时间记录 ===
格式：开始时间 | 结束时间 | 持续时间 | 进程名称
================================================================================

🚀 开始运行: 2025-01-15 14:30:25 | 进程: Diablo IV.exe
🔴 结束运行: 2025-01-15 16:45:12 | 持续时间: 02:14:47 | 进程: Diablo IV.exe
完整记录: 2025-01-15 14:30:25 -> 2025-01-15 16:45:12 (02:14:47)
--------------------------------------------------------------------------------

🚀 开始运行: 2025-01-15 17:00:05 | 进程: Diablo IV.exe
⚠️ 异常退出: 2025-01-15 17:30:18 | 持续时间: 00:30:13 | 原因: 用户手动停止任务 | 进程: Diablo IV.exe
完整记录: 2025-01-15 17:00:05 -> 2025-01-15 17:30:18 (00:30:13) [异常退出]
--------------------------------------------------------------------------------
```

## 🔧 工作原理

### 自动记录触发点

1. **启动记录**：
   - 软件B首次启动成功时
   - 软件B重新启动成功时

2. **结束记录**：
   - 软件B正常结束时
   - 软件B异常退出时
   - 用户手动停止任务时

### 记录内容

| 字段 | 说明 | 格式 |
|------|------|------|
| 开始时间 | 软件B启动的具体时间 | YYYY-MM-DD HH:MM:SS |
| 结束时间 | 软件B结束的具体时间 | YYYY-MM-DD HH:MM:SS |
| 持续时间 | 软件B运行的总时长 | HH:MM:SS |
| 进程名称 | 监控的软件B进程名 | 如：Diablo IV.exe |

## 📊 统计功能

系统会自动统计：
- **总运行次数**：软件B启动的总次数
- **总运行时间**：所有运行时间的累计

## 🎯 使用说明

### 无需额外配置
运行时间记录功能是自动启用的，无需任何额外配置。当您：

1. 点击"开始任务"
2. 软件B成功启动
3. 系统会自动开始记录时间

### 查看日志
- 直接打开项目目录下的 `software_b_runtime.log` 文件
- 使用任何文本编辑器都可以查看

### 日志管理
- 日志文件会持续累积记录
- 如需清空历史记录，直接删除日志文件即可
- 系统会在下次运行时自动创建新的日志文件

## 🛡️ 错误处理

系统具备完善的错误处理机制：

- **进程检测失败**：会记录为异常退出
- **用户强制停止**：会记录停止原因
- **程序崩溃**：会记录异常状态
- **文件写入失败**：会在控制台显示错误信息

## 🔍 技术实现

### 核心组件
- **RuntimeLogger类**：专门的运行时间记录器
- **自动集成**：与现有的进程监控系统完美集成
- **线程安全**：支持多线程环境下的安全记录

### 监控点
- TaskThread.run() - 首次启动监控
- standby_monitoring_loop() - 后续运行监控
- stop() - 手动停止处理

## 📈 数据分析

通过日志文件，您可以分析：

1. **使用频率**：每天软件B启动次数
2. **使用时长**：平均每次运行时间
3. **稳定性**：正常结束 vs 异常退出比例
4. **使用习惯**：主要使用时间段

## 🎉 总结

运行时间记录功能为您的自动化工具增加了重要的数据收集能力，帮助您：

- 📊 了解软件B的实际使用情况
- 🔍 发现潜在的稳定性问题
- 📈 优化使用策略和时间安排
- 📝 保留完整的运行历史记录

所有记录都是自动进行的，无需任何手动干预，让您专注于其他重要的工作！ 